To install chapi on a machine running the old clearinghouse:

 1. Install the chapidev branch of proto-ch in the usual way:

  * use Makefile.sync on your own laptop
  * do-make-install.sh on your portal

 2. Checkout the chapi repository, develop branch on your laptop

  * git clone trac.gpolab.bbn.com:/srv/git/chapi.git
  * cd chapi
  * git checkout develop

 3. Copy chapi/chapi/tools/install_chapi your portal VM

  * scp chapi/tools/install_chapi your-host.example.com:

 4. Make an empty directory on your portal VM

  * mkdir /tmp/chapi
  * cp /path/to/install_chapi /tmp/chapi

 5. Run the installer

  * cd /tmp/chapi
  * ./install_chapi <VM name e.g. ch-ph.gpolab.bbn.com>

 6. Copy the chapi package from your laptop onto your VM

  * rsync -aztv /path/to/chapi/chapi your-host.example.com

 7. Build chapi on your VM

  * cd "${HOME}"/chapi
  * autoreconf --install
  * ./configure --prefix=/usr --sysconfdir=/etc \
          --bindir=/usr/local/bin --sbindir=/usr/local/sbin
  * make
  * sudo make install
  * sudo service apache2 restart

 8. Create a chapi config file

  * cp /etc/geni-chapi/example-chapi.ini /etc/geni-chapi/chapi.ini
  * edit /etc/geni-chapi/chapi.ini
   - Set chrm.authority to your VM CNAME
   - Set db_url if necessary

 9. Restart apache one more time

  * sudo service apache2 restart


To update the chapi code with a newer version:

 1. Copy the chapi package from your laptop onto your VM

  * rsync -aztv /path/to/chapi/chapi your-host.example.com

 2. Build chapi on your VM

  * cd "${HOME}"/chapi
  * autoreconf --install
  * ./configure --prefix=/usr --sysconfdir=/etc --bindir=/usr/local/bin --sbindir=/usr/local/sbin
  * make
  * sudo make install
  * sudo service apache2 restart
